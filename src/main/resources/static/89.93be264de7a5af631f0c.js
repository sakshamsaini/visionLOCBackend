(self.webpackChunkmystical=self.webpackChunkmystical||[]).push([[89],{4089:(t,e,a)=>{"use strict";a.r(e),a.d(e,{ViewModule:()=>S});var n=a(8583),i=a(8741),o=a(2916),r=a(7716),s=a(2340),l=a(1841);let c=(()=>{class t{constructor(t){this.http=t}getDetectedObjectList(){return this.http.get(`${s.N.VISIONLOC_API_URL}detected-objects`)}postMarker(t){return this.http.post(`${s.N.VISIONLOC_API_URL}marker`,t)}getMarkerList(){return this.http.get(`${s.N.VISIONLOC_API_URL}markers`)}deleteMarker(t){return this.http.delete(`${s.N.VISIONLOC_API_URL}marker/${t}`)}postDrawing(t){return this.http.post(`${s.N.VISIONLOC_API_URL}drawing`,t)}getDrawingList(){return this.http.get(`${s.N.VISIONLOC_API_URL}drawings`)}deleteDrawing(t){return this.http.delete(`${s.N.VISIONLOC_API_URL}drawing/${t}`)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(l.eN))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=a(665),g=a(8295),p=a(9983),u=a(1095);function h(t,e){if(1&t&&(r.TgZ(0,"div",13),r._UZ(1,"img",14),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("src",t.imagePreview,r.LSH)}}function m(t,e){if(1&t&&(r.TgZ(0,"p",15),r._uU(1),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Oqu(t.imageError)}}let b=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.data=e,this.viewController=a,this.selectedImage=null,this.imagePreview=null,this.imageError=null,this.getJson=(t,e,a)=>({label:t,latitude:e,longitude:a})}ngOnInit(){}onImageSelected(t){const e=t.target;if(e.files&&e.files.length>0){this.selectedImage=e.files[0];const t=2;if(this.selectedImage.size>1024*t*1024)return void(this.imageError=`Image is too large. Max allowed size is ${t} MB.`);const a=new FileReader;a.onload=()=>{this.imagePreview=a.result},a.readAsDataURL(this.selectedImage)}}onSave(){const t=this.toFormData(),e=this.getJson(this.data.label,this.data.latitude,this.data.longitude);t.append("payload",JSON.stringify(e)),this.viewController.postMarker(t).subscribe(t=>{},t=>{console.log("error in onSave() -",t)}),this.dialogRef.close(Object.assign(Object.assign({},this.data),{image:this.selectedImage,imageBase64:this.imagePreview}))}toFormData(){const t=new FormData;return this.selectedImage&&t.append("filePayload",this.selectedImage,this.selectedImage.name),t}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(o.so),r.Y36(o.WI),r.Y36(c))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-add-custom-marker-dialog"]],decls:25,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["form","ngForm"],["appearance","fill",1,"full-width"],["matInput","","name","label","required","",3,"ngModel","ngModelChange"],["matInput","","name","latitude","type","number","required","",3,"ngModel","ngModelChange"],["matInput","","name","longitude","type","number","required","",3,"ngModel","ngModelChange"],["type","file","accept","image/*",3,"change"],["style","margin-top: 10px;",4,"ngIf"],["class","error",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary",3,"disabled","click"],[2,"margin-top","10px"],["alt","Preview","width","100",3,"src"],[1,"error"]],template:function(t,e){if(1&t&&(r.TgZ(0,"h2",0),r._uU(1,"Add Marker"),r.qZA(),r.TgZ(2,"div",1),r.TgZ(3,"form",null,2),r.TgZ(5,"mat-form-field",3),r.TgZ(6,"mat-label"),r._uU(7,"Label"),r.qZA(),r.TgZ(8,"input",4),r.NdJ("ngModelChange",function(t){return e.data.label=t}),r.qZA(),r.qZA(),r.TgZ(9,"mat-form-field",3),r.TgZ(10,"mat-label"),r._uU(11,"Latitude"),r.qZA(),r.TgZ(12,"input",5),r.NdJ("ngModelChange",function(t){return e.data.latitude=t}),r.qZA(),r.qZA(),r.TgZ(13,"mat-form-field",3),r.TgZ(14,"mat-label"),r._uU(15,"Longitude"),r.qZA(),r.TgZ(16,"input",6),r.NdJ("ngModelChange",function(t){return e.data.longitude=t}),r.qZA(),r.qZA(),r.TgZ(17,"input",7),r.NdJ("change",function(t){return e.onImageSelected(t)}),r.qZA(),r.YNc(18,h,2,1,"div",8),r.YNc(19,m,2,1,"p",9),r.qZA(),r.qZA(),r.TgZ(20,"div",10),r.TgZ(21,"button",11),r._uU(22,"Cancel"),r.qZA(),r.TgZ(23,"button",12),r.NdJ("click",function(){return e.onSave()}),r._uU(24,"Save"),r.qZA(),r.qZA()),2&t){const t=r.MAs(4);r.xp6(8),r.Q6J("ngModel",e.data.label),r.xp6(4),r.Q6J("ngModel",e.data.latitude),r.xp6(4),r.Q6J("ngModel",e.data.longitude),r.xp6(2),r.Q6J("ngIf",e.imagePreview),r.xp6(1),r.Q6J("ngIf",e.imageError),r.xp6(4),r.Q6J("disabled",!t.valid)}},directives:[o.uh,o.xY,d._Y,d.JL,d.F,g.KE,g.hX,p.Nt,d.Fj,d.Q7,d.JJ,d.On,d.wV,n.O5,o.H8,u.lW,o.ZT],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.error[_ngcontent-%COMP%]{color:red;font-weight:700}"]}),t})(),f=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.data=e,this.viewController=a}ngOnInit(){}onSave(){this.data.jsonObj.label=this.data.label,this.viewController.postDrawing(this.data.jsonObj).subscribe(t=>{},t=>{console.log("error in onSave() -",t)}),this.dialogRef.close(Object.assign({},this.data))}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(o.so),r.Y36(o.WI),r.Y36(c))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-add-label-dialog"]],decls:14,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["form","ngForm"],["appearance","fill",1,"full-width"],["matInput","","name","label","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(r.TgZ(0,"h2",0),r._uU(1,"Add Label"),r.qZA(),r.TgZ(2,"div",1),r.TgZ(3,"form",null,2),r.TgZ(5,"mat-form-field",3),r.TgZ(6,"mat-label"),r._uU(7,"Label"),r.qZA(),r.TgZ(8,"input",4),r.NdJ("ngModelChange",function(t){return e.data.label=t}),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"button",6),r._uU(11,"Cancel"),r.qZA(),r.TgZ(12,"button",7),r.NdJ("click",function(){return e.onSave()}),r._uU(13,"Save"),r.qZA(),r.qZA()),2&t){const t=r.MAs(4);r.xp6(8),r.Q6J("ngModel",e.data.label),r.xp6(4),r.Q6J("disabled",!t.valid)}},directives:[o.uh,o.xY,d._Y,d.JL,d.F,g.KE,g.hX,p.Nt,d.Fj,d.Q7,d.JJ,d.On,o.H8,u.lW,o.ZT],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}"]}),t})(),M=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.data=e,this.viewController=a}ngOnInit(){}deleteDrawing(){this.viewController.deleteDrawing(this.data.id).subscribe({next:t=>{},error:t=>{console.error("Error in deleteDrawing:",t)}}),this.dialogRef.close(Object.assign({},this.data))}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(o.so),r.Y36(o.WI),r.Y36(c))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-delete-drawing-dialog"]],decls:13,vars:2,consts:[["mat-dialog-title",""],[1,"fw-bold"],["mat-dialog-content",""],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.TgZ(0,"h2",0),r.TgZ(1,"span",1),r._uU(2),r.qZA(),r.qZA(),r.TgZ(3,"div",2),r._uU(4," Are you sure you want to delete "),r.TgZ(5,"span",1),r._uU(6),r.qZA(),r._uU(7," ?\n"),r.qZA(),r.TgZ(8,"div",3),r.TgZ(9,"button",4),r._uU(10,"Cancel"),r.qZA(),r.TgZ(11,"button",5),r.NdJ("click",function(){return e.deleteDrawing()}),r._uU(12,"Delete"),r.qZA(),r.qZA()),2&t&&(r.xp6(2),r.hij(" Delete ",e.data.shapeName," "),r.xp6(4),r.hij(" ",e.data.label," "))},directives:[o.uh,o.xY,o.H8,u.lW,o.ZT],styles:[""]}),t})();var w=a(5396);const k=["mapContainer"];function Z(t,e){1&t&&r.GkF(0)}const C=function(t,e,a){return{label:t,latitude:e,longitude:a,id:null}};function O(t,e){if(1&t&&(r.ynx(0),r.YNc(1,Z,1,0,"ng-container",17),r.BQk()),2&t){const t=r.oxw().$implicit;r.oxw(2);const e=r.MAs(24);r.xp6(1),r.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",r.kEZ(2,C,t.label,t.latitude,t.longitude))}}function x(t,e){if(1&t&&(r.ynx(0),r.YNc(1,O,2,6,"ng-container",16),r.BQk()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("ngIf","camera"!=t.type)}}function v(t,e){if(1&t&&(r.TgZ(0,"div",14),r.TgZ(1,"h2",2),r._uU(2,"Detected Objects"),r.qZA(),r.YNc(3,x,2,1,"ng-container",15),r.qZA()),2&t){const t=r.oxw();r.xp6(3),r.Q6J("ngForOf",t.detectedObjectList)}}function A(t,e){1&t&&r.GkF(0)}const T=function(t,e,a,n){return{label:t,latitude:e,longitude:a,id:n}};function I(t,e){if(1&t&&(r.ynx(0),r.YNc(1,A,1,0,"ng-container",17),r.BQk()),2&t){const t=e.$implicit;r.oxw(2);const a=r.MAs(24);r.xp6(1),r.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",r.l5B(2,T,t.label,t.latitude,t.longitude,t.id))}}function y(t,e){if(1&t&&(r.TgZ(0,"div",14),r.TgZ(1,"h2",2),r._uU(2,"Markers"),r.qZA(),r.YNc(3,I,2,7,"ng-container",15),r.qZA()),2&t){const t=r.oxw();r.xp6(3),r.Q6J("ngForOf",t.customMarkerList)}}function _(t,e){1&t&&r._UZ(0,"img",26)}function D(t,e){1&t&&r._UZ(0,"img",27)}function q(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"span",28),r.NdJ("click",function(){r.CHM(t);const e=r.oxw().id;return r.oxw().deleteCustomMarker(e)}),r._UZ(1,"img",29),r.qZA()}}function P(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",18),r.TgZ(1,"div",19),r.YNc(2,_,1,0,"img",20),r.YNc(3,D,1,0,"img",21),r.qZA(),r.TgZ(4,"div",22),r._uU(5),r._UZ(6,"br"),r._uU(7),r.ALo(8,"number"),r.ALo(9,"number"),r.qZA(),r.TgZ(10,"div",23),r.TgZ(11,"mat-slide-toggle",24),r.NdJ("change",function(e){const a=r.CHM(t),n=a.label,i=a.latitude;return r.oxw().removeMarkerFromMap(n,i,e)}),r.qZA(),r.YNc(12,q,2,0,"span",25),r.qZA(),r.qZA()}if(2&t){const t=e.label,a=e.longitude,n=e.latitude,i=e.id;r.xp6(2),r.Q6J("ngIf",null==i),r.xp6(1),r.Q6J("ngIf",null!=i),r.xp6(2),r.hij(" ",t," "),r.xp6(2),r.AsE(" ",r.xi3(8,6,n,"1.6-7")," , ",r.xi3(9,9,a,"1.6-7")," "),r.xp6(5),r.Q6J("ngIf",null!=i)}}const N=[{path:"",component:(()=>{class t{constructor(t,e){this.viewController=t,this.dialog=e,this.latitude=0,this.longitude=0,this.showLogs=!1,this.showMarkers=!1,this.detectedObjectList=[],this.customMarkerList=[],this.drawingList=[],this.markerMap=new Map,this.imageMarkersMap=new Map}ngOnInit(){this.detectedObjectList=this.getDetectedObjectList()}ngAfterViewInit(){this.initMapLayer(),this.baseMaps={"Map View":this.mapLayer,"Satellite View":this.satelliteLayer},this.initMap(),this.addDetectedObjectMarkers(this.detectedObjectList),this.addControlWithLayers(),this.showLatLong(),this.initDrawControls(),this.dragAndDropCustomMarker(),this.getCustomMarkerList(),this.getDrawingList()}initMap(){this.map=L.map(this.mapContainer.nativeElement,{center:[27.188984,78.0257536],zoom:12,minZoom:8,maxZoom:19,zoomControl:!0,attributionControl:!0}),this.mapLayer.addTo(this.map)}initMapLayer(){this.mapLayerFn(),this.satelliteLayerFn()}mapLayerFn(){this.mapLayer=L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,minZoom:8,attribution:"Map View"})}satelliteLayerFn(){this.satelliteLayer=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:19,minZoom:8,attribution:"Satellite View"})}addDetectedObjectMarkers(t){t.forEach(t=>{const e=this.getIconAndImageByType(t.type),a=L.icon({iconUrl:e,iconSize:[33,35],iconAnchor:[12,41]}),n=L.marker([t.latitude,t.longitude],{icon:a}).addTo(this.map);this.addTooltipToMarker(t.label,n),"camera"!=t.type&&this.showImageOnMarkerClick(n,t.imageType,t.imageBase64),this.markerMap.set(t.latitude,n)})}getIconAndImageByType(t){let e="";switch(t){case"person":e="assets/icons/person.png";break;case"vehicle":e="assets/icons/vehicle_car.png";break;case"animal":e="assets/icons/animal.png";break;case"camera":e="assets/icons/camera.png";break;default:e="assets/icons/location.png"}return e}addTooltipToMarker(t,e){e.bindTooltip(`<b>${t}</b><br>`,{permanent:!1,direction:"top"})}showImageOnMarkerClick(t,e,a){t.on("click",()=>{if(this.imageMarkersMap.has(t))return;const n=t.getLatLng(),i=L.latLng(n.lat,n.lng-7e-4),o=L.divIcon({html:`<img src="data:${e};base64,${a}" style="width:600px; height:350px;" />`,iconSize:[300,100],iconAnchor:[0,0]}),r=L.marker(i,{icon:o,interactive:!0}).addTo(this.map);this.imageMarkersMap.set(t,r),r.on("click",()=>{this.map.removeLayer(r),this.imageMarkersMap.delete(t)})})}addControlWithLayers(){L.control.layers(this.baseMaps).addTo(this.map),L.control.scale({imperial:!1,metric:!0}).addTo(this.map)}showLatLong(){this.map.on("mousemove",t=>{this.latitude=t.latlng.lat,this.longitude=t.latlng.lng})}getDetectedObjectList(){return this.viewController.getDetectedObjectList().subscribe({next:t=>{if(this.detectedObjectList=t,this.map)this.addDetectedObjectMarkers(this.detectedObjectList),this.map.setView([this.detectedObjectList[0].latitude,this.detectedObjectList[0].longitude],10);else{const t=setInterval(()=>{this.map&&(this.addDetectedObjectMarkers(this.detectedObjectList),clearInterval(t))},100)}},error:t=>{console.error("Error in getDetectedObjectList:",t)}}),this.detectedObjectList}initDrawControls(){const t=new L.FeatureGroup;this.map.addLayer(t);const e=new L.Control.Draw({draw:{polygon:!0,polyline:!0,rectangle:!0,circle:!0,marker:!1,circlemarker:!1,path:!0},edit:{featureGroup:t}});this.map.addControl(e),this.map.on("draw:created",e=>{const a=e.layer;console.log(a),t.addLayer(a);let n="",i=0,o=0,r={};if(a instanceof L.Polygon){console.log("Polygon coordinates:",a.getLatLngs());const t=a.getLatLngs()[0],e=L.GeometryUtil.geodesicArea(t)/1e3;i=t[0].lat,o=t[0].lng,n=`Area covered: ${e.toFixed(2)} km\xb2`,r=this.createJsonForDrawings("POLYGON","",t,e,null,null)}else if(a instanceof L.Polyline){const t=a.getLatLngs();console.log("Polyline coordinates:",t,t.length);let e=[];for(let a=0;a<t.length-1;a++){const r=this.calculateBearing(t[a].lat,t[a].lng,t[a+1].lat,t[a+1].lng),s=(r+180)%360;e.push({bearing:r,backBearing:s}),i=t[a].lat,o=t[a].lng,n=`Bearing: ${r.toFixed(2)}\xb0<br>Backbearing: ${s.toFixed(2)}\xb0`}r=this.createJsonForDrawings("POLYLINE","",t,null,e,null)}else if(a instanceof L.Circle){const t=a._latlng;console.log("Circle coordinates:",a._latlng);const e=a.getRadius(),s=Math.PI*e*e/1e3;i=t.lat,o=t.lng,n=`Area covered: ${s.toFixed(2)} km\xb2`,r=this.createJsonForDrawings("CIRCLE","",[t],s,null,e)}else console.log("Unknown layer:",a);0!=i&&0!=o&&(this.showPopup(i,o,n),a.on("click",t=>{this.showPopup(i,o,n)}),this.openAddlabelDialog(r))})}createJsonForDrawings(t,e,a,n,i,o){return{shapeName:t,label:e,latlng:a,area:n,bearAndbackBearing:i,radius:o}}showPopup(t,e,a){L.popup().setLatLng([t,e]).setContent(a).addTo(this.map)}removeMarkerFromMap(t,e,a){const n=this.markerMap.get(e);n&&(null!=a&&a.checked?(this.map.addLayer(n),this.addTooltipToMarker(t,n)):this.map.removeLayer(n))}deleteCustomMarker(t){this.viewController.deleteMarker(t).subscribe({next:t=>{this.getCustomMarkerList()},error:t=>{console.error("Error in deleteCustomMarker:",t)}})}addCustomMarker(t,e){if(null!=t.image){let a=L.icon({iconUrl:t.imageBase64,iconSize:[23,25],iconAnchor:[12,41]});e.setIcon(a)}e.unbindPopup(),this.addTooltipToMarker(t.label,e)}calculateBearing(t,e,a,n){const i=t=>t*Math.PI/180,o=i(t),r=i(a),s=i(n-e),l=Math.sin(s)*Math.cos(r),c=Math.cos(o)*Math.sin(r)-Math.sin(o)*Math.cos(r)*Math.cos(s);return(180*Math.atan2(l,c)/Math.PI+360)%360}onDragStart(t){var e;null===(e=t.dataTransfer)||void 0===e||e.setData("text/plain","button")}dragAndDropCustomMarker(){const t=this.map.getContainer();t.addEventListener("dragover",t=>{t.preventDefault()}),t.addEventListener("drop",e=>{e.preventDefault();const a=t.getBoundingClientRect(),n=this.map.containerPointToLatLng([e.clientX-a.left,e.clientY-a.top]);let i=n.lat,o=n.lng,r=`Dropped at:<br><b>Lat:</b> ${i.toFixed(5)}<br><b>Lng:</b> ${o.toFixed(5)}`;const s=L.marker([i,o]).addTo(this.map);this.showCustomMarkerPopup(i,o,r),this.openAddCustomMarkerDialog(i,o,s),s.on("click",t=>{this.openAddCustomMarkerDialog(i,o,s)})})}showCustomMarkerPopup(t,e,a){L.popup({offset:L.point(0,-20)}).setLatLng([t,e]).setContent(a).addTo(this.map)}getCustomMarkerList(){return this.viewController.getMarkerList().subscribe({next:t=>{if(this.customMarkerList=t,this.map)this.addCustomMarkersOnMap(this.customMarkerList);else{const t=setInterval(()=>{this.map&&(this.addCustomMarkersOnMap(this.customMarkerList),clearInterval(t))},100)}},error:t=>{console.error("Error in getCustomMarkerList:",t)}}),this.customMarkerList}getDrawingList(){return console.log("getting drawing list"),this.viewController.getDrawingList().subscribe({next:t=>{if(this.drawingList=t,this.map)this.addDrawingOnMap(this.drawingList);else{const t=setInterval(()=>{this.map&&(this.addDrawingOnMap(this.drawingList),clearInterval(t))},100)}},error:t=>{console.error("Error in getDrawingList:",t)}}),this.drawingList}addDrawingOnMap(t){t.forEach(t=>{const e=t.shapeName,a=t.label,n=t.id;if("POLYGON"==e){const i=t.latlng.map(t=>[t.lat,t.lng]),o=L.polygon(i,{weight:3,fillOpacity:.4}).addTo(this.map);o.on("mousemove",e=>{o.bindPopup(`Label: ${t.label} <br> Area: ${t.area.toFixed(2)} km\xb2`).openPopup(e.latlng)}),o.on("click",t=>{this.openDeleteDrawingDialog(n,e,a)})}else if("POLYLINE"==e){const i=t.latlng.map(t=>[t.lat,t.lng]),o=L.polyline(i,{}).addTo(this.map);t.bearAndbackBearing.forEach((e,a)=>{const n=i[a],o=i[a+1];if(n&&o){const a=L.circleMarker([(n[0]+o[0])/2,(n[1]+o[1])/2],{radius:5,fillOpacity:0}).addTo(this.map);a.on("mousemove",n=>{a.bindPopup(`<b>${t.label}</b><br> Bearing: ${e.bearing}\xb0<br>Back: ${e.backBearing}\xb0`).openPopup(n.latlng)})}}),o.on("click",t=>{this.openDeleteDrawingDialog(n,e,a)})}else if("CIRCLE"==e){const i=t.latlng[0],o=L.circle([i.lat,i.lng],{radius:t.radius,fillOpacity:.2}).addTo(this.map);o.on("mousemove",e=>{o.bindPopup(`Label: ${t.label} <br> Area: ${t.area.toFixed(2)} km\xb2`).openPopup(e.latlng)}),o.on("click",t=>{this.openDeleteDrawingDialog(n,e,a)})}})}addCustomMarkersOnMap(t){t.forEach(t=>{let e=L.marker();if(null!=t.image){const a=L.icon({iconUrl:`data:${t.imageType};base64,${t.image}`,iconSize:[33,35],iconAnchor:[12,41]});e=L.marker([t.latitude,t.longitude],{icon:a}).addTo(this.map)}else e=L.marker([t.latitude,t.longitude]).addTo(this.map);this.addTooltipToMarker(t.label,e),this.markerMap.set(t.latitude,e)})}openAddCustomMarkerDialog(t,e,a){this.dialog.open(b,{width:"500px",data:{label:"",latitude:t,longitude:e}}).afterClosed().subscribe(t=>{t&&(console.log("Dialog result:",t),this.addCustomMarker(t,a))})}openAddlabelDialog(t){this.dialog.open(f,{width:"500px",data:{label:"",jsonObj:t}}).afterClosed().subscribe(t=>{t&&console.log("Dialog result:",t)})}openDeleteDrawingDialog(t,e,a){this.dialog.open(M,{width:"500px",data:{id:t,shapeName:e,label:a}}).afterClosed().subscribe(t=>{t&&(console.log("Dialog result:",t),window.location.reload())})}changeFlagValues(t){"SHOW_LOGS"===t?(this.showLogs=!this.showLogs,this.showLogs&&(this.showMarkers=!1)):"SHOW_MARKERS"===t&&(this.showMarkers=!this.showMarkers,this.showMarkers&&(this.showLogs=!1))}ngOnDestroy(){this.map&&this.map.remove()}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c),r.Y36(o.uw))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-view"]],viewQuery:function(t,e){if(1&t&&r.Gf(k,5),2&t){let t;r.iGM(t=r.CRH())&&(e.mapContainer=t.first)}},decls:25,vars:12,consts:[[1,"header"],[1,"header-left"],[1,"title"],[1,"header-right"],["draggable","true",1,"btn",3,"dragstart"],[1,"btn",3,"click"],[1,"btn"],[1,"row"],[3,"ngClass"],["id","map",1,"map-container"],["mapContainer",""],["class","col-2 float-end",4,"ngIf"],[1,"coordinates"],["detectedObjects",""],[1,"col-2","float-end"],[4,"ngFor","ngForOf"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"row","mt-2"],[1,"col-2"],["src","assets/icons/pin_drop.svg","class","iconSize",4,"ngIf"],["src","assets/icons/marker-icon.png","class","customMarkerIcon",4,"ngIf"],[1,"col-6"],[1,"col-4"],["checked","","color","primary",3,"change"],[3,"click",4,"ngIf"],["src","assets/icons/pin_drop.svg",1,"iconSize"],["src","assets/icons/marker-icon.png",1,"customMarkerIcon"],[3,"click"],["src","assets/icons/delete.svg",1,"deleteIcon"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"p",2),r._uU(3,"VisionLOC - CCTV Object Detection Mapping Software"),r.qZA(),r.qZA(),r.TgZ(4,"div",3),r.TgZ(5,"button",4),r.NdJ("dragstart",function(t){return e.onDragStart(t)}),r._uU(6," Add Marker "),r.qZA(),r.TgZ(7,"button",5),r.NdJ("click",function(){return e.changeFlagValues("SHOW_LOGS")}),r._uU(8),r.qZA(),r.TgZ(9,"button",5),r.NdJ("click",function(){return e.changeFlagValues("SHOW_MARKERS")}),r._uU(10," Show Markers "),r.qZA(),r.TgZ(11,"button",6),r._uU(12,"Logout"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(13,"div",7),r.TgZ(14,"div",8),r._UZ(15,"div",9,10),r.qZA(),r.YNc(17,v,4,1,"div",11),r.YNc(18,y,4,1,"div",11),r.qZA(),r.TgZ(19,"div",12),r._uU(20),r.ALo(21,"number"),r.ALo(22,"number"),r.qZA(),r.YNc(23,P,13,12,"ng-template",null,13,r.W1O)),2&t&&(r.xp6(8),r.hij(" ",e.showLogs?"Hide Logs":"Show Logs"," "),r.xp6(6),r.Q6J("ngClass",e.showLogs||e.showMarkers?"col-10":"col-12"),r.xp6(3),r.Q6J("ngIf",e.showLogs),r.xp6(1),r.Q6J("ngIf",e.showMarkers),r.xp6(2),r.AsE(" ",r.xi3(21,6,e.latitude,"1.4-5"),", ",r.xi3(22,9,e.longitude,"1.4-5"),"\n"))},directives:[n.mk,n.O5,n.sg,n.tP,w.Rr],pipes:[n.JJ],styles:[".header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 18px;border-bottom:1px solid #e0e0e0}.header-left[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.header-left[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;margin-top:10px}.header-right[_ngcontent-%COMP%]{display:flex;grid-gap:12px;gap:12px}.header-right[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:#00966c;color:#fff;padding:10px 14px;border-radius:25px;font-weight:600;cursor:pointer;transition:background-color .2s}.header-right[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:#007d5b}.map-container[_ngcontent-%COMP%]{height:750px}.iconSize[_ngcontent-%COMP%]{font-size:35px;margin-top:5px}.customMarkerIcon[_ngcontent-%COMP%]{width:20px;height:25px;margin-top:5px}.deleteIcon[_ngcontent-%COMP%]{font-size:35px;margin-left:10px;margin-bottom:7px}.coordinates[_ngcontent-%COMP%]{position:absolute;bottom:5px;padding:5px;font-size:18px;font-weight:700}"]}),t})()}];let J=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[i.Bz.forChild(N)],i.Bz]}),t})();var U=a(674);let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[n.ez,U.IJ,J,w.rP,d.u5,u.ot,o.Is,p.c]]}),t})()}}]);